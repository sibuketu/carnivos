# ガイド失敗分析：Supabase RLS ガイド（ルール改善用）

**日付**: 2026-02  
**対象**: Supabase RLS 適用ガイド  
**ユーザー指摘**: 「貼るだけでどんだけ説明分かりにくくするんや」

---

## 1. 何が悪かったか（事実）

| 問題 | 具体 |
|------|------|
| ステップが多すぎた | やることは「URL を開く → SQL を貼る → Run」の 3 つなのに、7〜12 ステップあった。 |
| 不要な「開く」が必須に見えた | 「スキーマ（テーブル一覧）を開く」「ポリシー用 SQL ファイルを開く」を PC 上でやるステップを入れた。貼る内容はガイド内のコードブロックで完結しているのに、ローカルファイルを開く手順を入れた。 |
| 「貼る」が埋もれた | 本当にやることは「貼って Run」なのに、「どこで何を開くか」が前にたくさんあり、「貼る」が 5 番目以降になって分かりにくかった。 |
| 結論が後ろにあった | 「結論は 3 ステップだけ」「5のSQLを貼って Run だけでよい」と最初に書かず、手順の最後や簡略化の段階で初めて明言した。 |

---

## 2. なぜ起きたか（原因）

- **7.9 は「形式」だけ指定している**: 表形式・コードブロックは守ったが、「ステップ数を最小にする」「必須でないものはステップにしない」が 7.9 に書かれていなかった。
- **例外をステップにした**: 「存在しないテーブルに ALTER するとエラー」という注意から、「テーブル一覧を確認する」を**必須のステップ**にしてしまった。本来は「心配なら ○○ で確認」の 1 行注釈で足りる。
- **貼る内容の出所を 2 つにした**: 「ガイドのコードブロック」と「ローカルファイル（コメントを外してコピー）」の 2 通りを書いたため、「ファイルを開く」ステップを入れた。ユーザーはガイドのコードブロックだけ使えばよいので、ファイルを開くステップは不要だった。
- **「最小手順」を先に書くルールがなかった**: ガイド作成時に「ユーザーが実際にやる最小の手順」を最初に 1 文で書く、がルールにない。

---

## 3. ルール改善案（7.9 に追記すべき内容）

- **最小ステップの原則**: ガイドの手順は「ユーザーが実際にやる最小の行動」だけをステップにする。必須でない確認・補足は「任意」「注意」として表の外で 1 行に書く。
- **結論を先に 1 文**: ガイドの冒頭に「やることの結論」を 1 文で書く（例: 「やることは URL を開く → ○○ を貼る → Run の 3 つだけ」）。
- **「開く」を入れる条件**: 「〇〇を開く」ステップは、その先で「貼る・入力する」が必要で、**かつ**貼る・入力する内容を**その開いた先からコピーする場合だけ**入れる。貼る内容がガイド内のコードブロックで完結するなら「〇〇ファイルを開く」ステップは入れない。
- **「貼る」は 1 アクション**: 貼るものはコードブロックで直下に出す。選択肢が複数（例: daily_logs 用 / profiles 用）ある場合は、どれを選ぶかの 1 行説明と、それぞれのコードブロックを並べるだけでよい。「どこで開いてコピーするか」は書かない（ガイド内で完結させる）。

---

## 4. 今回のガイドでやるべきだったこと

1. 冒頭に「やること: URL を開く → 下の SQL を貼る → Run の 3 つだけ」と 1 文で書く。
2. ステップは 1＝URL を開く（コードブロック）、2＝貼る（コードブロック）、3＝Run のみ。
3. 「テーブルがないとエラーになる。心配なら supabase_schema.sql で確認」は表の下の 1 行注意にする。ステップにしない。
4. ローカルで「ポリシー用 SQL ファイルを開く」ステップは入れない。
