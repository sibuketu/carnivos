import{u as $,a as I,j as t,G as f,f as _,s as O}from"./index-CvGLKNdl.js";import{r as i}from"./chart-vendor-BKK2UjWf.js";import"./react-vendor-OvXVS5lI.js";import"./ai-vendor-9LcfXvm6.js";const b=[{id:"weight",label:"ä½“é‡",type:"number",unit:"kg",category:"physical",connectable:!0},{id:"bodyFatPercentage",label:"ä½“è„‚è‚ªç‡",type:"number",unit:"%",category:"physical",connectable:!0},{id:"bodyTemperature",label:"ä½“æ¸©",type:"number",unit:"â„ƒ",category:"physical",step:.1,connectable:!0},{id:"heartRate",label:"å®‰é™æ™‚å¿ƒæ‹æ•°",type:"number",unit:"bpm",category:"physical",connectable:!0},{id:"energyLevel",label:"ã‚¨ãƒãƒ«ã‚®ãƒ¼ãƒ¬ãƒ™ãƒ«",type:"slider",min:1,max:10,category:"physical"},{id:"physicalFatigue",label:"èº«ä½“çš„ç–²åŠ´æ„Ÿ",type:"slider",min:1,max:10,category:"physical"},{id:"muscleSoreness",label:"ç­‹è‚‰ç—›",type:"slider",min:1,max:10,category:"physical"},{id:"bowelMovement.status",label:"ä¾¿é€š",type:"select",options:["normal","constipated","loose","watery"],category:"physical"},{id:"libido",label:"æ€§æ¬²",type:"slider",min:1,max:10,category:"physical"},{id:"mood",label:"æ°—åˆ†",type:"select",options:["great","good","neutral","bad","terrible"],category:"mental"},{id:"focus",label:"é›†ä¸­åŠ›",type:"slider",min:1,max:10,category:"mental"},{id:"anxiety",label:"ä¸å®‰",type:"slider",min:1,max:10,category:"mental"},{id:"motivation",label:"ã‚„ã‚‹æ°—",type:"slider",min:1,max:10,category:"mental"},{id:"brainFog",label:"ãƒ–ãƒ¬ã‚¤ãƒ³ãƒ•ã‚©ã‚°",type:"slider",min:1,max:10,category:"mental"},{id:"stressLevel",label:"ã‚¹ãƒˆãƒ¬ã‚¹ãƒ¬ãƒ™ãƒ«",type:"select",options:["low","medium","high"],category:"mental",connectable:!0},{id:"sleepScore",label:"ç¡çœ ã‚¹ã‚³ã‚¢",type:"slider",min:0,max:100,category:"sleep",connectable:!0},{id:"sleepHours",label:"ç¡çœ æ™‚é–“",type:"number",unit:"h",category:"sleep",step:.5,connectable:!0},{id:"bedTime",label:"å°±åºŠæ™‚åˆ»",type:"time",category:"sleep",connectable:!0},{id:"wakeTime",label:"èµ·åºŠæ™‚åˆ»",type:"time",category:"sleep",connectable:!0},{id:"deepSleep",label:"æ·±ã„ç¡çœ ",type:"number",unit:"min",category:"sleep",connectable:!0},{id:"snoring",label:"ã„ã³ã",type:"boolean",category:"sleep",connectable:!0},{id:"socialInteractions",label:"ç¤¾äº¤é »åº¦",type:"slider",min:0,max:10,category:"social"},{id:"loneliness",label:"å­¤ç‹¬æ„Ÿ",type:"slider",min:1,max:10,category:"social"},{id:"socialSatisfaction",label:"ç¤¾äº¤æº€è¶³åº¦",type:"slider",min:1,max:10,category:"social"},{id:"sharedMeal",label:"èª°ã‹ã¨é£Ÿäº‹",type:"boolean",category:"social"},{id:"partnerIntimacy",label:"ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã¨ã®æ™‚é–“",type:"boolean",category:"social"},{id:"weather",label:"å¤©æ°—",type:"select",options:["sunny","cloudy","rainy","snowy"],category:"environment",connectable:!0},{id:"sunMinutes",label:"æ—¥å…‰æµ´",type:"number",unit:"min",category:"environment"},{id:"coldExposureMinutes",label:"å¯’å†·æš´éœ²",type:"number",unit:"min",category:"environment"},{id:"saunaMinutes",label:"ã‚µã‚¦ãƒŠ",type:"number",unit:"min",category:"environment"},{id:"meditationMinutes",label:"ç‘æƒ³",type:"number",unit:"min",category:"environment"}];function J({onBack:S}){const{t:w}=$(),{userProfile:C,loadTodayLog:M}=I(),g=new Date().toISOString().split("T")[0],[u,m]=i.useState(""),[r,k]=i.useState(g),[y,p]=i.useState({}),[n,c]=i.useState("favorites"),[o,v]=i.useState(["weight","sleepScore","mood","energyLevel","bowelMovement.status"]),[h,x]=i.useState(!1);i.useEffect(()=>{const e=localStorage.getItem("primal_logic_metric_favorites");e&&v(JSON.parse(e))},[]);const j=async()=>{try{const e=await f(r);e?(m(e.diary||""),p(e.status||{})):(m(""),p({}))}catch{}};i.useEffect(()=>{j();const e=()=>{j()};return window.addEventListener("externalDiaryUpdate",e),()=>{window.removeEventListener("externalDiaryUpdate",e)}},[r]);const d=(e,a)=>{p(l=>{if(e.includes(".")){const[s,F]=e.split(".");return{...l,[s]:{...l[s]||{},[F]:a}}}return{...l,[e]:a}})},E=e=>{const a=o.includes(e)?o.filter(l=>l!==e):[...o,e];v(a),localStorage.setItem("primal_logic_metric_favorites",JSON.stringify(a))},L=async()=>{x(!0);try{const e=await f(r),l={...e?.status||{sleepScore:0,sunMinutes:0,activityLevel:"moderate"},...y},s=e?{...e,diary:u.trim(),status:l}:{date:r,status:l,fuel:[],calculatedMetrics:_([],C||void 0),diary:u.trim()};await O(s),r===g&&(await M(),window.dispatchEvent(new CustomEvent("dailyLogUpdated")))}catch{alert(w("diary.saveFailed"))}finally{x(!1)}},D=e=>{if(e.includes(".")){const[a,l]=e.split(".");return y[a]?.[l]}return y[e]},T=e=>{const a=D(e.id),l=o.includes(e.id);return t.jsxs("div",{className:"metric-item",children:[t.jsxs("div",{className:"metric-row",children:[t.jsxs("div",{className:"metric-label-group",children:[t.jsx("span",{className:"metric-label",children:e.label}),e.connectable&&t.jsx("button",{className:"connect-button",title:"ãƒ‡ãƒã‚¤ã‚¹é€£æº (æœªå®Ÿè£…)",children:"ğŸ”—"})]}),t.jsx("button",{className:`favorite-toggle ${l?"active":""}`,onClick:()=>E(e.id),children:"â˜…"})]}),t.jsxs("div",{className:"metric-input-container",children:[e.type==="slider"&&t.jsxs("div",{className:"slider-wrapper",children:[t.jsx("input",{type:"range",min:e.min,max:e.max,value:a||e.min,onChange:s=>d(e.id,Number(s.target.value)),className:"metric-slider"}),t.jsx("span",{className:"slider-value",children:a||"-"})]}),e.type==="number"&&t.jsxs("div",{className:"number-wrapper",children:[t.jsx("input",{type:"number",step:e.step||1,value:a||"",onChange:s=>d(e.id,Number(s.target.value)),className:"metric-number-input"}),t.jsx("span",{className:"metric-unit",children:e.unit})]}),e.type==="select"&&t.jsxs("select",{value:a||"",onChange:s=>d(e.id,s.target.value),className:"metric-select",children:[t.jsx("option",{value:"",children:"é¸æŠ"}),e.options?.map(s=>t.jsx("option",{value:s,children:s},s))]}),e.type==="boolean"&&t.jsx("div",{className:"toggle-wrapper",children:t.jsx("button",{className:`toggle-btn ${a===!0?"active":""}`,onClick:()=>d(e.id,!a),children:a?"YES":"NO"})}),e.type==="time"&&t.jsx("input",{type:"time",value:a||"",onChange:s=>d(e.id,s.target.value),className:"metric-time-input"})]})]},e.id)},N=n==="all"?b:n==="favorites"?b.filter(e=>o.includes(e.id)):b.filter(e=>e.category===n);return t.jsxs("div",{className:"diary-screen-container",children:[t.jsxs("div",{className:"diary-screen-header",children:[t.jsx("button",{onClick:S,className:"back-button",children:"â†"}),t.jsx("h1",{className:"diary-screen-title",children:"Bio-Tuner"}),t.jsx("div",{className:"date-selector",children:t.jsx("input",{type:"date",value:r,onChange:e=>k(e.target.value)})})]}),t.jsxs("div",{className:"diary-tabs",children:[t.jsx("button",{className:`tab-btn ${n==="favorites"?"active":""}`,onClick:()=>c("favorites"),children:"â˜… ãŠæ°—ã«å…¥ã‚Š"}),t.jsx("button",{className:`tab-btn ${n==="all"?"active":""}`,onClick:()=>c("all"),children:"ã™ã¹ã¦"}),t.jsx("button",{className:`tab-btn ${n==="physical"?"active":""}`,onClick:()=>c("physical"),children:"èº«ä½“"}),t.jsx("button",{className:`tab-btn ${n==="mental"?"active":""}`,onClick:()=>c("mental"),children:"ãƒ¡ãƒ³ã‚¿ãƒ«"}),t.jsx("button",{className:`tab-btn ${n==="sleep"?"active":""}`,onClick:()=>c("sleep"),children:"ç¡çœ "}),t.jsx("button",{className:`tab-btn ${n==="social"?"active":""}`,onClick:()=>c("social"),children:"ç¤¾äº¤"}),t.jsx("button",{className:`tab-btn ${n==="environment"?"active":""}`,onClick:()=>c("environment"),children:"ç’°å¢ƒ"})]}),t.jsxs("div",{className:"diary-content-scroll",children:[t.jsx("div",{className:"metrics-grid",children:N.length>0?N.map(T):t.jsx("div",{className:"empty-state",children:n==="favorites"?"ã‚·ã‚¹ãƒ†ãƒ ç›£è¦–ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒæœªç™»éŒ²ã§ã™ã€‚â˜…ã‚’æŠ¼ã—ã¦ç›£è¦–é …ç›®ã‚’è¿½åŠ ã—ã¦ãã ã•ã„ã€‚":"é …ç›®ãŒã‚ã‚Šã¾ã›ã‚“"})}),t.jsxs("div",{className:"diary-text-section",children:[t.jsx("h3",{children:"è‡ªç”±è¨˜è¿°æ—¥è¨˜"}),t.jsx("textarea",{value:u,onChange:e=>m(e.target.value),placeholder:"ä»Šæ—¥ã®å‡ºæ¥äº‹ã€ä½“èª¿è©³ç´°ã€é£Ÿã¹ãŸã‚‚ã®ã®æ„Ÿæƒ³ãªã©...",rows:6,className:"diary-textarea"})]}),t.jsx("button",{onClick:L,className:"save-log-button",disabled:h,children:h?"ä¿å­˜ä¸­...":"è¨˜éŒ²ã‚’ä¿å­˜"})]})]})}export{J as default};
