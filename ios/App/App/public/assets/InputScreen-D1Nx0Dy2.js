import{u as $e,a as Ee,W as De,o as ie,j as e,f as Me,X as ze,Y as Le}from"./index-CvGLKNdl.js";import{r}from"./chart-vendor-BKK2UjWf.js";import"./react-vendor-OvXVS5lI.js";import"./ai-vendor-9LcfXvm6.js";function We(u){const{minutes:o,isSunny:y,exposureArea:p="partial",weatherFactor:f,uvIndex:b,cloudCover:j}=u,i=p==="full"?600:120;let m=i;if(f!==void 0)m=i*f;else if(m=y?i:i*.4,b!==void 0&&j!==void 0){const B=.3+b/11*1.2,w=(100-j)/100;m=i*Math.min(B,1.5)*w}const x=m*o;if(o>60){const B=m*60,w=m*.3*(o-60);return Math.round(B+w)}return Math.round(x)}const ae="primal_logic_weather_cache",Pe=3600*1e3;async function He(){return new Promise(u=>{if(!navigator.geolocation){u(null);return}navigator.geolocation.getCurrentPosition(o=>{u({lat:o.coords.latitude,lon:o.coords.longitude})},o=>{u(null)},{timeout:1e4,maximumAge:300*1e3})})}async function Ue(u,o){try{return null}catch{return null}}async function fe(u,o){try{const y=Ke();if(y)return y;let p=null;if(u&&o||(p=await He()),!p)return null;const f=void 0;if(!f)return null;const b=await fetch(`https://api.openweathermap.org/data/2.5/weather?lat=${p.lat}&lon=${p.lon}&appid=${f}&units=metric&lang=ja`);if(!b.ok)throw new Error(`Weather API error: ${b.status}`);const j=await b.json();let i=0;try{const A=await fetch(`https://api.openweathermap.org/data/2.5/uvi?lat=${p.lat}&lon=${p.lon}&appid=${f}`);A.ok&&(i=(await A.json()).value||0)}catch{}const m=j.weather[0]?.id||800;let x="cloudy";m>=800&&m<803?x="sunny":m===803||m===804?x="cloudy":m>=801&&m<803?x="partly-cloudy":m>=200&&m<600?x="rainy":m>=600&&m<700&&(x="snowy");const B=await Ue(p.lat,p.lon),w={temperature:j.main.temp||0,condition:x,uvIndex:Math.round(i*10)/10,cloudCover:j.clouds?.all||0,humidity:j.main.humidity||0,location:B||void 0,timestamp:new Date().toISOString()};return Oe(w),w}catch{return null}}function Ke(){try{const u=localStorage.getItem(ae);if(!u)return null;const o=JSON.parse(u);if(Date.now()-o.cachedAt>Pe)return localStorage.removeItem(ae),null;const{cachedAt:f,...b}=o;return b}catch{return null}}function Oe(u){try{const o={...u,cachedAt:Date.now()};localStorage.setItem(ae,JSON.stringify(o))}catch{}}function Ve(u){let o=1;switch(o*=(100-u.cloudCover)/100,u.condition){case"sunny":o*=1;break;case"partly-cloudy":o*=.7;break;case"cloudy":o*=.3;break;case"rainy":case"snowy":o*=.1;break}const y=.5+u.uvIndex/11*1;return o*=Math.min(y,1.5),Math.max(0,Math.min(1,o))}function Qe({onClose:u}={}){$e();const{addFood:o,removeFood:y,updateFood:p,updateStatus:f,updateDiary:b,updateWeight:j,dailyLog:i,userProfile:m}=Ee(),[x,B]=r.useState(i?.status.sleepScore||80),[w,A]=r.useState(i?.status.sleepHours?.toString()||""),[z,ye]=r.useState(i?.status.sunMinutes||30),[V,_]=r.useState(!0),[v,re]=r.useState(null),[oe,Z]=r.useState(!1),[le,be]=r.useState(i?.status.activityLevel||"moderate"),[je,X]=r.useState(i?.diary||""),[L,ce]=r.useState(i?.weight?.toString()||""),[q,ue]=r.useState(i?.bodyFatPercentage?.toString()||""),[$,E]=r.useState(i?.status?.mood||"neutral"),[J,de]=r.useState([]),[D,me]=r.useState(i?.status?.energyLevel||5),[we,Ne]=r.useState(i?.status?.focus||5),[S,pe]=r.useState(i?.status?.brainFog||1),[C,W]=r.useState(i?.status?.bowelMovement||{status:"normal"}),[I,Re]=r.useState({}),[G,Ce]=r.useState(!1),[Q,Se]=r.useState(!1),he=t=>{const n=I[t]||"",a=prompt(`${t.toUpperCase()}ã«ã¤ã„ã¦ã®ãƒ¡ãƒ¢:`,n);if(a!==null&&(Re({...I,[t]:a}),a&&a!==n)){const l=`[${new Date().toLocaleTimeString("ja-JP",{hour:"2-digit",minute:"2-digit"})}] ${t==="sleep"?"ğŸ’¤":t==="excretion"?"ğŸ’©":t==="mental"?"ğŸ§ ":t==="sun"?"â˜€ï¸":"ğŸƒ"} ${a}`;X(c=>c?`${c}
${l}`:l)}},P=({section:t,hasNote:n})=>e.jsx("button",{onClick:()=>he(t),style:{background:"none",border:"none",cursor:"pointer",fontSize:"1.2rem",marginLeft:"auto",opacity:n?1:.3,transition:"opacity 0.2s"},title:"ãƒ¡ãƒ¢ã‚’è¿½åŠ ",children:"ğŸ“"}),ge=({isOpen:t,onToggle:n,label:a="è©³ç´°"})=>e.jsxs("div",{onClick:n,style:{fontSize:"0.8rem",color:t?"#3b82f6":"#9ca3af",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px",userSelect:"none"},children:[e.jsx("span",{children:a}),e.jsx("span",{style:{transform:t?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.2s"},children:"â–¼"})]});r.useEffect(()=>{i?.diary!==void 0&&X(i.diary),i?.weight!==void 0&&ce(i.weight.toString()),i?.bodyFatPercentage!==void 0&&ue(i.bodyFatPercentage.toString()),i?.status?.sleepHours!==void 0&&A(i.status.sleepHours.toString()),i?.status?.bowelMovement&&W(i.status.bowelMovement),i?.status?.mood&&E(i.status.mood),i?.status?.energyLevel&&me(i.status.energyLevel),i?.status?.focus&&Ne(i.status.focus),i?.status?.brainFog&&pe(i.status.brainFog)},[i?.diary,i?.weight,i?.bodyFatPercentage,i?.status?.sleepHours,i?.status?.bowelMovement,i?.status?.mood,i?.status?.energyLevel,i?.status?.focus,i?.status?.brainFog]);const[N,H]=r.useState(""),[ve,U]=r.useState("300"),[R,ee]=r.useState("g"),[Be,K]=r.useState(!1),[s,M]=r.useState(null),[Ie,te]=r.useState(!1),[ne,se]=r.useState("300"),[F,Fe]=r.useState("g"),[k,Y]=r.useState(!1),T=r.useMemo(()=>new De({language:"ja-JP",continuous:!1,interimResults:!0}),[]);r.useEffect(()=>(T.onResult(t=>{if(H(t.text),t.isFinal){Y(!1),K(!0);const n=ie(t.text);n.length>0&&M(n[0])}}),T.onError(t=>{console.error("Voice input error:",t),Y(!1)}),T.onEnd(()=>{Y(!1)}),()=>{T.stop()}),[T]);const ke=()=>{k?T.stop():(H(""),T.start(),Y(!0))},O=r.useMemo(()=>N.length<1?[]:ie(N),[N]);r.useEffect(()=>{(async()=>{Z(!0);try{const n=await fe();n&&(re(n),_(n.condition==="sunny"||n.condition==="partly-cloudy"))}catch{}finally{Z(!1)}})()},[]);const xe=r.useMemo(()=>{const t=v?Ve(v):void 0;return We({minutes:z,isSunny:V,exposureArea:"partial",weatherFactor:t,uvIndex:v?.uvIndex,cloudCover:v?.cloudCover})},[z,V,v]),Te=()=>{if(!N.trim())return;const t=Number(ve)||(R==="å€‹"?1:100);if(t<=0)return;let n;const a=O.find(l=>l.name.toLowerCase()===N.toLowerCase().trim());a?n=a:(n=ze(N.trim()),!n&&O.length>0&&(n=O[0]));const h=Le(N);let g;if(n){let l,c;R==="å€‹"&&n.pieceWeight?(l=Number(t)*Number(n.pieceWeight),c="å€‹"):(l=Number(t),c="g");const d=l/100;g={item:n.name,amount:R==="å€‹"?t:l,unit:c,type:n.type,nutrients:{protein:(n.nutrientsRaw.protein||0)*d,fat:(n.nutrientsRaw.fat||0)*d,carbs:(n.nutrientsRaw.carbs||0)*d,netCarbs:((n.nutrientsRaw.carbs||0)-(n.nutrientsRaw.fiber||0))*d,fiber:(n.nutrientsRaw.fiber||0)*d,hemeIron:(n.nutrientsRaw.hemeIron||0)*d,nonHemeIron:(n.nutrientsRaw.nonHemeIron||0)*d,vitaminA:(n.nutrientsRaw.vitaminA||0)*d,vitaminC:(n.nutrientsRaw.vitaminC||0)*d,vitaminK:(n.nutrientsRaw.vitaminK||0)*d,vitaminB1:(n.nutrientsRaw.vitaminB1||0)*d,vitaminB2:(n.nutrientsRaw.vitaminB2||0)*d,vitaminB3:(n.nutrientsRaw.vitaminB3||0)*d,vitaminB6:(n.nutrientsRaw.vitaminB6||0)*d,vitaminB12:(n.nutrientsRaw.vitaminB12||0)*d,vitaminE:(n.nutrientsRaw.vitaminE||0)*d,zinc:(n.nutrientsRaw.zinc||0)*d,sodium:(n.nutrientsRaw.sodium||0)*d,magnesium:(n.nutrientsRaw.magnesium||0)*d,calcium:(n.nutrientsRaw.calcium||0)*d,phosphorus:(n.nutrientsRaw.phosphorus||0)*d,selenium:(n.nutrientsRaw.selenium||0)*d,copper:(n.nutrientsRaw.copper||0)*d,manganese:(n.nutrientsRaw.manganese||0)*d}}}else{const l=R==="å€‹"?t*50:t,c=l/100;g={item:N,amount:R==="å€‹"?t:l,unit:R==="å€‹"?"å€‹":"g",type:h?"trash":"animal",nutrients:{protein:20*c,fat:15*c,carbs:h?30*c:0,netCarbs:h?30*c:0,fiber:h?2*c:0,hemeIron:h?0:1*c,nonHemeIron:h?1*c:0,vitaminA:h?0:10*c,vitaminC:h?5*c:0,vitaminK:h?0:1*c,zinc:h?.5*c:2*c,sodium:h?500*c:50*c,magnesium:h?10*c:20*c}}}o(g),H(""),U(R==="å€‹"?"1":"300"),ee("g"),K(!1),M(null)},Ae=()=>{f({sleepScore:x,sleepHours:w?Number(w):void 0,sunMinutes:z,activityLevel:le,bowelMovement:C,mood:$,energyLevel:D,focus:we,brainFog:S}),u&&u()};return e.jsxs("div",{className:"input-screen-container",children:[e.jsxs("div",{className:"input-screen-content",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("h1",{className:"input-screen-title",children:"æ—¥æ¬¡å…¥åŠ›"}),u&&e.jsx("button",{onClick:u,style:{fontSize:"1.5rem",border:"none",background:"none",cursor:"pointer",padding:"0.5rem"},children:"Ã—"})]}),e.jsxs("div",{className:"input-screen-section",children:[e.jsx("h2",{className:"input-screen-section-title",children:"ç‡ƒæ–™ï¼ˆå…¥åŠ›ï¼‰"}),e.jsxs("div",{className:"input-screen-input-group",children:[e.jsx("label",{className:"input-screen-label",children:"é£Ÿå“:"}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[e.jsx("input",{type:"text",className:"input-screen-text-input",value:N,onChange:t=>{const n=t.target.value;if(H(n),K(n.length>=1),n.length>=1){const a=ie(n);a.length>0?M(a[0]):M(null)}else M(null)},placeholder:"e.g., è±š, Ribeye, Eggs, Butter...",onFocus:()=>K(N.length>=1),style:{flex:1}}),e.jsx("button",{onClick:ke,className:`voice-input-button ${k?"listening":""}`,style:{padding:"0.75rem",borderRadius:"50%",border:"none",backgroundColor:k?"#ef4444":"#f3f4f6",color:k?"white":"#6b7280",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s",boxShadow:k?"0 0 0 3px rgba(239, 68, 68, 0.3)":"none"},title:k?"éŸ³å£°å…¥åŠ›ã‚’åœæ­¢":"éŸ³å£°ã§å…¥åŠ›",children:k?e.jsx("span",{style:{fontSize:"1.2rem",animation:"pulse 1.5s infinite"},children:"â¹ï¸"}):e.jsx("span",{style:{fontSize:"1.2rem"},children:"ğŸ¤"})})]}),Be&&O.length>0&&e.jsx("div",{className:"input-screen-suggestions",children:O.slice(0,10).map(t=>e.jsxs("div",{className:"input-screen-suggestion-item",onClick:()=>{H(t.name),M(t),t.preferredUnit&&(ee(t.preferredUnit==="piece"?"å€‹":"g"),t.preferredUnit==="piece"&&t.pieceWeight&&U("1")),K(!1)},children:[e.jsx("span",{className:"input-screen-suggestion-text",children:t.name}),e.jsx("span",{className:"input-screen-suggestion-type",children:t.type})]},t.id))}),s&&e.jsxs("div",{className:"food-info-display",children:[e.jsxs("h4",{className:"food-info-title",children:["é¸æŠä¸­ã®é£Ÿå“: ",s.name]}),e.jsxs("div",{className:"food-info-grid",children:[e.jsxs("div",{children:["ã‚¿ãƒ³ãƒ‘ã‚¯è³ª: ",s.nutrientsRaw.protein||0,"g/100g"]}),e.jsxs("div",{children:["è„‚è³ª: ",s.nutrientsRaw.fat||0,"g/100g"]}),s.nutrientsRaw.vitaminB12&&e.jsxs("div",{children:["ãƒ“ã‚¿ãƒŸãƒ³B12: ",s.nutrientsRaw.vitaminB12,"Î¼g/100g"]}),s.nutrientsRaw.vitaminB1&&e.jsxs("div",{children:["ãƒ“ã‚¿ãƒŸãƒ³B1: ",s.nutrientsRaw.vitaminB1,"mg/100g"]}),s.nutrientsRaw.vitaminB2&&e.jsxs("div",{children:["ãƒ“ã‚¿ãƒŸãƒ³B2: ",s.nutrientsRaw.vitaminB2,"mg/100g"]}),s.nutrientsRaw.vitaminB3&&e.jsxs("div",{children:["ãƒ“ã‚¿ãƒŸãƒ³B3: ",s.nutrientsRaw.vitaminB3,"mg/100g"]}),s.nutrientsRaw.vitaminB6&&e.jsxs("div",{children:["ãƒ“ã‚¿ãƒŸãƒ³B6: ",s.nutrientsRaw.vitaminB6,"mg/100g"]}),s.nutrientsRaw.vitaminA&&e.jsxs("div",{children:["ãƒ“ã‚¿ãƒŸãƒ³A: ",s.nutrientsRaw.vitaminA,"Î¼g/100g"]}),s.nutrientsRaw.vitaminC&&e.jsxs("div",{children:["ãƒ“ã‚¿ãƒŸãƒ³C: ",s.nutrientsRaw.vitaminC,"mg/100g"]}),s.nutrientsRaw.vitaminK&&e.jsxs("div",{children:["ãƒ“ã‚¿ãƒŸãƒ³K: ",s.nutrientsRaw.vitaminK,"Î¼g/100g"]}),s.nutrientsRaw.vitaminE&&e.jsxs("div",{children:["ãƒ“ã‚¿ãƒŸãƒ³E: ",s.nutrientsRaw.vitaminE,"mg/100g"]}),s.nutrientsRaw.hemeIron&&e.jsxs("div",{children:["é‰„åˆ†ï¼ˆãƒ˜ãƒ ï¼‰: ",s.nutrientsRaw.hemeIron,"mg/100g"]}),s.nutrientsRaw.nonHemeIron&&e.jsxs("div",{children:["é‰„åˆ†ï¼ˆéãƒ˜ãƒ ï¼‰: ",s.nutrientsRaw.nonHemeIron,"mg/100g"]}),s.nutrientsRaw.zinc&&e.jsxs("div",{children:["äºœé‰›: ",s.nutrientsRaw.zinc,"mg/100g"]}),s.nutrientsRaw.sodium&&e.jsxs("div",{children:["ãƒŠãƒˆãƒªã‚¦ãƒ : ",s.nutrientsRaw.sodium,"mg/100g"]}),s.nutrientsRaw.magnesium&&e.jsxs("div",{children:["ãƒã‚°ãƒã‚·ã‚¦ãƒ : ",s.nutrientsRaw.magnesium,"mg/100g"]}),s.nutrientsRaw.calcium&&e.jsxs("div",{children:["ã‚«ãƒ«ã‚·ã‚¦ãƒ : ",s.nutrientsRaw.calcium,"mg/100g"]}),s.nutrientsRaw.phosphorus&&e.jsxs("div",{children:["ãƒªãƒ³: ",s.nutrientsRaw.phosphorus,"mg/100g"]}),s.nutrientsRaw.selenium&&e.jsxs("div",{children:["ã‚»ãƒ¬ãƒ³: ",s.nutrientsRaw.selenium,"Î¼g/100g"]}),s.nutrientsRaw.copper&&e.jsxs("div",{children:["éŠ…: ",s.nutrientsRaw.copper,"mg/100g"]}),s.nutrientsRaw.manganese&&e.jsxs("div",{children:["ãƒãƒ³ã‚¬ãƒ³: ",s.nutrientsRaw.manganese,"mg/100g"]}),s.nutrientsRaw.carbs&&e.jsxs("div",{children:["ç‚­æ°´åŒ–ç‰©: ",s.nutrientsRaw.carbs,"g/100g"]}),s.nutrientsRaw.fiber&&e.jsxs("div",{children:["é£Ÿç‰©ç¹Šç¶­: ",s.nutrientsRaw.fiber,"g/100g"]})]}),e.jsx("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:e.jsx("button",{onClick:()=>te(!0),style:{padding:"0.5rem 1rem",backgroundColor:"#34C759",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"0.9rem"},children:"ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼"})})]}),e.jsxs("div",{className:"input-screen-amount-row",children:[e.jsx("label",{className:"input-screen-label",children:"é‡:"}),e.jsxs("div",{className:"input-screen-amount-input-group",children:[e.jsx("input",{type:"number",className:"input-screen-text-input input-screen-amount-input",value:ve,onChange:t=>U(t.target.value),placeholder:R==="å€‹"?"1":"100",min:"0",step:"1"}),e.jsxs("select",{className:"input-screen-unit-select",value:R,onChange:t=>{const n=t.target.value;ee(n),U(n==="å€‹"?"1":"300")},children:[e.jsx("option",{value:"g",children:"g"}),e.jsx("option",{value:"å€‹",children:"å€‹"})]})]})]}),e.jsx("button",{className:"input-screen-add-button",onClick:Te,style:{marginTop:"1rem"},children:"é£Ÿã¹ç‰©ã‚’è¿½åŠ "})]})]})]}),e.jsxs("div",{className:"input-screen-section",children:[e.jsx("h2",{className:"input-screen-section-title",children:"çŠ¶æ…‹ï¼ˆãƒã‚·ãƒ³ãƒ»ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ï¼‰"}),e.jsxs("div",{className:"input-screen-input-group",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",marginBottom:"0.5rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsxs("label",{className:"input-screen-label",style:{marginBottom:0},children:["1. ç¡çœ  (Vital): ",x]}),e.jsx(P,{section:"sleep",hasNote:!!I.sleep})]}),e.jsx(ge,{isOpen:G,onToggle:()=>Ce(!G)})]}),e.jsxs("div",{className:"input-screen-slider-container",children:[e.jsx("input",{type:"range",min:"0",max:"100",value:x,onChange:t=>B(Number(t.target.value)),step:"1",className:"input-screen-slider",style:{background:`linear-gradient(to right, #3b82f6 ${x}%, #e5e7eb ${x}%)`}}),!G&&e.jsxs("div",{className:"input-screen-slider-hint",style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{children:"ğŸ˜« Bad"}),e.jsx("span",{children:"Recovered ğŸ¦"})]})]}),G&&e.jsxs("div",{style:{marginTop:"1rem",paddingTop:"1rem",borderTop:"1px dashed #e5e7eb"},children:[e.jsxs("div",{className:"input-screen-input-group",children:[e.jsx("label",{className:"input-screen-label",children:"ç¡çœ æ™‚é–“"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("input",{type:"number",value:w,onChange:t=>A(t.target.value),placeholder:"7.5",step:"0.5",className:"input-screen-text-input",style:{width:"80px"}}),e.jsx("span",{className:"input-screen-unit",children:"æ™‚é–“"})]})]}),e.jsxs("div",{style:{marginTop:"0.5rem"},children:[e.jsx("label",{className:"input-screen-sublabel",children:"è³ª (Quality Tags)"}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem"},children:["ä¸­é€”è¦šé†’","æ‚ªå¤¢","å¯èµ·ãè‰¯","ã‚¹ãƒƒã‚­ãƒª"].map(t=>e.jsx("button",{className:"btn-micro",onClick:()=>he("sleep"),children:t},t))})]})]})]}),e.jsxs("div",{className:"input-screen-input-group",style:{marginTop:"1.5rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",width:"100%"},children:[e.jsx("label",{className:"input-screen-label",style:{marginBottom:0},children:"2. Bio-Tuner (Output & Log):"}),e.jsx(P,{section:"excretion",hasNote:!!I.excretion})]}),e.jsxs("div",{className:"input-screen-button-row",children:[e.jsx("button",{className:`input-screen-level-button ${C.status==="normal"?"active":""}`,onClick:()=>W({...C,status:"normal"}),children:"Normal ğŸ¦"}),e.jsx("button",{className:`input-screen-level-button ${C.status==="constipated"?"active":""}`,onClick:()=>W({...C,status:"constipated"}),children:"Hard ğŸ§±"}),e.jsx("button",{className:`input-screen-level-button ${C.status==="loose"?"active":""}`,onClick:()=>W({...C,status:"loose"}),children:"Soft ğŸ’§"}),e.jsx("button",{className:`input-screen-level-button ${C.status==="watery"?"active":""}`,onClick:()=>W({...C,status:"watery"}),children:"Water ğŸŒŠ"})]}),e.jsx("div",{className:"input-screen-slider-hint",children:"è„‚è³ªæ‘‚å–é‡ã®æœ€é©åŒ–ã‚·ã‚°ãƒŠãƒ«"}),e.jsxs("div",{style:{marginTop:"1rem",borderTop:"1px dashed #e5e7eb",paddingTop:"1rem"},children:[e.jsx("label",{className:"input-screen-label",style:{fontSize:"0.95rem"},children:"System Log (è€ƒå¯Ÿãƒ»åˆ†æ)"}),e.jsx("textarea",{className:"input-screen-text-input",value:je,onChange:t=>{X(t.target.value),b(t.target.value)},placeholder:"Protocol Note: å¤‰æ•°ï¼ˆé£Ÿäº‹ãƒ»ç¡çœ ãƒ»ã‚¹ãƒˆãƒ¬ã‚¹ï¼‰ã¨å‡ºåŠ›ã®ç›¸é–¢ã‚’è¨˜éŒ²...",rows:3,style:{resize:"vertical",minHeight:"80px",fontFamily:"inherit",fontSize:"0.9rem"}}),e.jsx("div",{style:{marginTop:"0.5rem",display:"flex",justifyContent:"flex-end"},children:e.jsx("button",{onClick:t=>{t.preventDefault();const n=new CustomEvent("navigateToScreen",{detail:"diary"});window.dispatchEvent(n)},style:{fontSize:"0.85rem",color:"#4b5563",background:"none",border:"none",textDecoration:"underline",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.25rem",padding:"4px"},children:"ğŸ““ è©³ç´°ãƒ­ã‚°ã‚’é–‹ã (Open Detailed Log)"})})]})]}),e.jsxs("div",{className:"input-screen-input-group",style:{marginTop:"1.5rem",borderTop:"1px dashed #e5e7eb",paddingTop:"1rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",marginBottom:"0.5rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx("label",{className:"input-screen-label",style:{marginBottom:0},children:"3. ãƒ¡ãƒ³ã‚¿ãƒ« (Operator):"}),e.jsx(P,{section:"mental",hasNote:!!I.mental})]}),e.jsx(ge,{isOpen:Q,onToggle:()=>Se(!Q)})]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{className:"input-screen-sublabel",style:{display:"block",marginBottom:"0.5rem",fontSize:"0.9rem",color:"#555"},children:"Mood Spectrum"}),e.jsxs("div",{className:"input-screen-button-row",style:{justifyContent:"space-between"},children:[e.jsx("button",{className:`btn-neo ${$==="terrible"?"active":""}`,onClick:()=>E("terrible"),title:"Rage / Irritated",children:"ğŸ¤¬ Rage"}),e.jsx("button",{className:`btn-neo ${$==="bad"?"active":""}`,onClick:()=>E("bad"),title:"Apathy / Depressed",children:"ğŸ˜‘ Apathy"}),e.jsx("button",{className:`btn-neo ${$==="neutral"?"active":""}`,onClick:()=>E("neutral"),title:"Neutral / Calm",children:"ğŸ˜ Calm"}),e.jsx("button",{className:`btn-neo ${$==="good"?"active":""}`,onClick:()=>E("good"),title:"Clear / Focused",children:"âœ¨ Clear"}),e.jsx("button",{className:`btn-neo ${$==="great"?"active":""}`,onClick:()=>E("great"),title:"High / Euphoric",children:"ğŸ¦ Lion"})]})]}),!Q&&e.jsxs("div",{style:{fontSize:"0.8rem",color:"#666",marginTop:"-0.5rem"},children:["Brain Fog: ",S," / Energy: ",D]}),Q&&e.jsxs("div",{style:{marginTop:"1rem",paddingTop:"1rem",borderTop:"1px dashed #e5e7eb"},children:[e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{className:"input-screen-sublabel",children:"Detailed Emotions"}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px"},children:["Anxiety","Grief","Overwhelm","Boredom","Flow","Gratitude"].map(t=>e.jsx("button",{className:`btn-micro ${J.includes(t)?"active":""}`,onClick:()=>{J.includes(t)?de(J.filter(n=>n!==t)):de([...J,t])},children:t},t))})]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsxs("label",{className:"input-screen-sublabel",style:{display:"block",marginBottom:"0.5rem"},children:["ãƒ–ãƒ¬ã‚¤ãƒ³ãƒ•ã‚©ã‚° (",S,")"]}),e.jsx("input",{type:"range",min:"1",max:"10",value:S,onChange:t=>pe(Number(t.target.value)),className:"input-screen-slider",style:{background:`linear-gradient(to right, #34d399 ${100-S*10}%, #9ca3af ${100-S*10}%)`}}),e.jsx("div",{className:"input-screen-slider-hint",children:S<=2?"âœ¨ Crystal Clear":S>=8?"â˜ï¸ Heavy Fog":"Normal"})]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsxs("label",{className:"input-screen-sublabel",style:{display:"block",marginBottom:"0.5rem"},children:["ã‚¨ãƒãƒ«ã‚®ãƒ¼ (",D,")"]}),e.jsx("input",{type:"range",min:"1",max:"10",value:D,onChange:t=>me(Number(t.target.value)),className:"input-screen-slider",style:{background:`linear-gradient(to right, #f59e0b ${D*10}%, #e5e7eb ${D*10}%)`}})]})]})]}),e.jsxs("div",{className:"input-screen-input-group",style:{marginTop:"1.5rem",borderTop:"1px dashed #e5e7eb",paddingTop:"1rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",width:"100%"},children:[e.jsx("label",{className:"input-screen-label",style:{marginBottom:0},children:"4. å¤ªé™½å…‰ (Environment):"}),e.jsx(P,{section:"sun",hasNote:!!I.sun})]}),e.jsxs("div",{className:"input-screen-solar-charge-row",children:[e.jsx("input",{type:"number",value:z.toString(),onChange:t=>ye(Number(t.target.value)||0),placeholder:"30",className:"input-screen-text-input input-screen-solar-charge-input"}),e.jsx("span",{className:"input-screen-unit",children:"åˆ†"}),e.jsxs("div",{className:"input-screen-weather-buttons",children:[e.jsx("button",{className:`input-screen-weather-button ${V?"active":""}`,onClick:()=>_(!0),children:"â˜€ï¸ Sunny"}),e.jsx("button",{className:`input-screen-weather-button ${V?"":"active"}`,onClick:()=>_(!1),children:"â˜ï¸ Cloudy"}),e.jsx("button",{className:"input-screen-weather-button",onClick:async()=>{Z(!0);try{const t=await fe();t&&(re(t),_(t.condition==="sunny"||t.condition==="partly-cloudy"))}catch{}finally{Z(!1)}},disabled:oe,title:"å¤©æ°—æƒ…å ±ã‚’è‡ªå‹•å–å¾—",children:oe?"â³":"ğŸŒ¤ï¸"})]})]}),v&&e.jsxs("div",{className:"input-screen-weather-info",style:{fontSize:"0.875rem",color:"#666",marginTop:"0.5rem"},children:[v.location&&`${v.location} - `,v.condition==="sunny"?"â˜€ï¸ æ™´ã‚Œ":v.condition==="partly-cloudy"?"â›… æ›‡ã‚ŠãŒã¡":v.condition==="cloudy"?"â˜ï¸ æ›‡ã‚Š":v.condition==="rainy"?"ğŸŒ§ï¸ é›¨":"â„ï¸ é›ª",v.temperature>0&&` ${Math.round(v.temperature)}â„ƒ`,v.uvIndex>0&&` UV: ${v.uvIndex}`]}),xe>0&&e.jsxs("div",{className:"input-screen-vitamin-d",children:["Estimated Vitamin D: ~",xe.toLocaleString()," IU"]})]}),e.jsxs("div",{className:"input-screen-input-group",style:{marginTop:"1.5rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",width:"100%"},children:[e.jsx("label",{className:"input-screen-label",style:{marginBottom:0},children:"5. æ´»å‹•ãƒ¬ãƒ™ãƒ« (Output):"}),e.jsx(P,{section:"activity",hasNote:!!I.activity})]}),e.jsx("div",{className:"input-screen-button-row",children:["high","moderate","low"].map(t=>e.jsx("button",{className:`input-screen-level-button ${le===t?"active":""}`,onClick:()=>be(t),children:t.charAt(0).toUpperCase()+t.slice(1)},t))})]})]}),e.jsxs("div",{className:"input-screen-section",children:[e.jsx("h2",{className:"input-screen-section-title",children:"ä½“é‡ãƒ»ä½“çµ„æˆ"}),e.jsxs("div",{className:"input-screen-input-group",children:[e.jsx("label",{className:"input-screen-label",children:"ä½“é‡ (kg)"}),e.jsxs("div",{className:"input-screen-solar-charge-row",children:[e.jsx("input",{type:"number",value:L,onChange:t=>{const n=t.target.value;ce(n);const a=n===""?void 0:Number(n);j(a,q===""?void 0:Number(q)||void 0)},placeholder:"ä¾‹: 70.5",step:"0.1",min:"0",className:"input-screen-text-input input-screen-solar-charge-input"}),e.jsx("span",{className:"input-screen-unit",children:"kg"})]})]}),e.jsxs("div",{className:"input-screen-input-group",children:[e.jsx("label",{className:"input-screen-label",children:"ä½“è„‚è‚ªç‡ (%)"}),e.jsxs("div",{className:"input-screen-solar-charge-row",children:[e.jsx("input",{type:"number",value:q,onChange:t=>{const n=t.target.value;ue(n);const a=n===""?void 0:Number(n);j(L===""?void 0:Number(L)||void 0,a)},placeholder:"ä¾‹: 15.0",step:"0.1",min:"0",max:"100",className:"input-screen-text-input input-screen-solar-charge-input"}),e.jsx("span",{className:"input-screen-unit",children:"%"})]})]}),L&&m?.height&&e.jsx("div",{className:"input-screen-input-group",style:{marginTop:"1rem",padding:"0.75rem",backgroundColor:"#f9fafb",borderRadius:"8px"},children:e.jsxs("div",{style:{fontSize:"14px",color:"#78716c"},children:[e.jsx("strong",{children:"BMI:"})," ",(Number(L)/(m.height/100)**2).toFixed(1),m.height&&e.jsxs("span",{style:{marginLeft:"1rem",fontSize:"12px"},children:["(èº«é•·: ",m.height,"cm)"]})]})})]}),e.jsx("button",{className:"input-screen-save-button",onClick:Ae,children:"æ—¥æ¬¡çŠ¶æ…‹ã‚’ä¿å­˜"}),i&&i.fuel.length>0&&e.jsxs("div",{className:"input-screen-added-foods",children:[e.jsx("h3",{className:"input-screen-section-title",children:"ä»Šæ—¥é£Ÿã¹ãŸã‚‚ã®:"}),i.fuel.map((t,n)=>e.jsxs("div",{className:"input-screen-added-food-item",style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0.75rem",backgroundColor:"#f9f9f9",borderRadius:"8px",marginBottom:"0.5rem"},children:[e.jsxs("div",{children:[e.jsx("strong",{children:t.item})," - ",t.amount,t.unit]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsx("button",{onClick:()=>{const a=prompt("é‡ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼ˆgï¼‰:",t.amount.toString());if(a&&!isNaN(Number(a))){const h=Number(a)/t.amount,g={...t,amount:Number(a),nutrients:Object.fromEntries(Object.entries(t.nutrients||{}).map(([l,c])=>[l,(c||0)*h]))};p(n,g)}},style:{padding:"0.25rem 0.5rem",fontSize:"0.8rem",backgroundColor:"#007AFF",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"ç·¨é›†"}),e.jsx("button",{onClick:()=>{window.confirm(`${t.item}ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ`)&&y(n)},style:{padding:"0.25rem 0.5rem",fontSize:"0.8rem",backgroundColor:"#FF3B30",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"å‰Šé™¤"})]})]},n))]}),Ie&&s&&i&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3},onClick:()=>te(!1),children:e.jsxs("div",{style:{backgroundColor:"white",padding:"2rem",borderRadius:"8px",maxWidth:"90%",maxHeight:"90%",overflow:"auto",position:"relative"},onClick:t=>t.stopPropagation(),children:[e.jsx("button",{onClick:()=>te(!1),style:{position:"absolute",top:"1rem",right:"1rem",background:"none",border:"none",fontSize:"1.5rem",cursor:"pointer"},children:"Ã—"}),e.jsxs("h2",{style:{marginBottom:"1rem"},children:["ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼: ",s.name," (",ne,F,"è¿½åŠ ã—ãŸå ´åˆ)"]}),e.jsxs("div",{style:{marginBottom:"1rem",display:"flex",gap:"0.5rem",alignItems:"center"},children:[e.jsx("label",{children:"é‡:"}),e.jsx("input",{type:"number",value:ne,onChange:t=>se(t.target.value),style:{width:"100px",padding:"0.5rem",border:"1px solid #ddd",borderRadius:"4px"},min:"0",step:"1"}),e.jsxs("select",{value:F,onChange:t=>{const n=t.target.value;Fe(n),se(n==="å€‹"?"1":"300")},style:{padding:"0.5rem",border:"1px solid #ddd",borderRadius:"4px"},children:[e.jsx("option",{value:"g",children:"g"}),e.jsx("option",{value:"å€‹",children:"å€‹"})]})]}),(()=>{const t=Number(ne)||(F==="å€‹"?1:300);let n;F==="å€‹"&&s.pieceWeight?n=t*s.pieceWeight:n=t;const a=n/100,h={item:s.name,amount:F==="å€‹"?t:n,unit:F==="å€‹"?"å€‹":"g",type:s.type,nutrients:{protein:(s.nutrientsRaw.protein||0)*a,fat:(s.nutrientsRaw.fat||0)*a,carbs:(s.nutrientsRaw.carbs||0)*a,netCarbs:((s.nutrientsRaw.carbs||0)-(s.nutrientsRaw.fiber||0))*a,fiber:(s.nutrientsRaw.fiber||0)*a,hemeIron:(s.nutrientsRaw.hemeIron||0)*a,nonHemeIron:(s.nutrientsRaw.nonHemeIron||0)*a,vitaminA:(s.nutrientsRaw.vitaminA||0)*a,vitaminC:(s.nutrientsRaw.vitaminC||0)*a,vitaminK:(s.nutrientsRaw.vitaminK||0)*a,vitaminB1:(s.nutrientsRaw.vitaminB1||0)*a,vitaminB2:(s.nutrientsRaw.vitaminB2||0)*a,vitaminB3:(s.nutrientsRaw.vitaminB3||0)*a,vitaminB6:(s.nutrientsRaw.vitaminB6||0)*a,vitaminB12:(s.nutrientsRaw.vitaminB12||0)*a,vitaminE:(s.nutrientsRaw.vitaminE||0)*a,zinc:(s.nutrientsRaw.zinc||0)*a,sodium:(s.nutrientsRaw.sodium||0)*a,magnesium:(s.nutrientsRaw.magnesium||0)*a,calcium:(s.nutrientsRaw.calcium||0)*a,phosphorus:(s.nutrientsRaw.phosphorus||0)*a,selenium:(s.nutrientsRaw.selenium||0)*a,copper:(s.nutrientsRaw.copper||0)*a,manganese:(s.nutrientsRaw.manganese||0)*a}},g=i?.calculatedMetrics||{effectiveProtein:0,fatTotal:0,vitaminB12Total:0,effectiveIron:0,effectiveZinc:0},l=Me([...i?.fuel||[],h],m||{});return e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"1rem"},children:[e.jsxs("div",{children:[e.jsx("h3",{style:{marginBottom:"0.5rem",color:"#333"},children:"ç¾åœ¨ã®å€¤"}),e.jsxs("div",{children:["ã‚¿ãƒ³ãƒ‘ã‚¯è³ªï¼ˆæœ‰åŠ¹ï¼‰: ",g.effectiveProtein.toFixed(1),"g"]}),e.jsxs("div",{children:["è„‚è³ª: ",g.fatTotal.toFixed(1),"g"]}),e.jsxs("div",{children:["ãƒ“ã‚¿ãƒŸãƒ³B12: ",g.vitaminB12Total?.toFixed(1)||"0.0","Î¼g"]}),e.jsxs("div",{children:["é‰„åˆ†ï¼ˆæœ‰åŠ¹ï¼‰: ",g.effectiveIron.toFixed(1),"mg"]}),e.jsxs("div",{children:["äºœé‰›ï¼ˆæœ‰åŠ¹ï¼‰: ",g.effectiveZinc.toFixed(1),"mg"]})]}),e.jsxs("div",{children:[e.jsx("h3",{style:{marginBottom:"0.5rem",color:"#333"},children:"è¿½åŠ å¾Œã®å€¤"}),e.jsxs("div",{children:["ã‚¿ãƒ³ãƒ‘ã‚¯è³ªï¼ˆæœ‰åŠ¹ï¼‰: ",l.effectiveProtein.toFixed(1),"g"," ",e.jsxs("span",{style:{color:"#34C759"},children:["(+",(l.effectiveProtein-g.effectiveProtein).toFixed(1),"g)"]})]}),e.jsxs("div",{children:["è„‚è³ª: ",l.fatTotal.toFixed(1),"g"," ",e.jsxs("span",{style:{color:"#34C759"},children:["(+",(l.fatTotal-g.fatTotal).toFixed(1),"g)"]})]}),e.jsxs("div",{children:["ãƒ“ã‚¿ãƒŸãƒ³B12: ",l.vitaminB12Total?.toFixed(1)||"0.0","Î¼g"," ",e.jsxs("span",{style:{color:"#34C759"},children:["(+",((l.vitaminB12Total||0)-(g.vitaminB12Total||0)).toFixed(1),"Î¼g)"]})]}),e.jsxs("div",{children:["é‰„åˆ†ï¼ˆæœ‰åŠ¹ï¼‰: ",l.effectiveIron.toFixed(1),"mg"," ",e.jsxs("span",{style:{color:"#34C759"},children:["(+",(l.effectiveIron-g.effectiveIron).toFixed(1),"mg)"]})]}),e.jsxs("div",{children:["äºœé‰›ï¼ˆæœ‰åŠ¹ï¼‰: ",l.effectiveZinc.toFixed(1),"mg"," ",e.jsxs("span",{style:{color:"#34C759"},children:["(+",(l.effectiveZinc-g.effectiveZinc).toFixed(1),"mg)"]})]})]})]})})()]})})]})}export{Qe as default};
