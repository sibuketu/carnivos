import{j as t,t as x,s as h}from"./index-CvGLKNdl.js";import{r}from"./chart-vendor-BKK2UjWf.js";import"./react-vendor-OvXVS5lI.js";import"./ai-vendor-9LcfXvm6.js";function S({onBack:m}){const[a,i]=r.useState(!1),[p,o]=r.useState(!1),[l,n]=r.useState(null),s=r.useRef(null),f=async()=>{const c=s.current?.files?.[0];if(!c){alert("ファイルを選択してください");return}i(!0),o(!1),n(null);try{const d=await c.text(),e=JSON.parse(d);if(!e.version)throw new Error("無効なデータ形式です");if(!window.confirm(`既存のデータを上書きしますか？
（推奨: 先にエクスポートしてバックアップを取ってください）`)){i(!1);return}if(e.userProfile&&await x(e.userProfile),e.settings&&localStorage.setItem("primal_logic_settings",JSON.stringify(e.settings)),e.dailyLogs&&Array.isArray(e.dailyLogs))for(const u of e.dailyLogs)await h(u);o(!0),alert("データのインポートが完了しました"),setTimeout(()=>{window.location.reload()},1e3)}catch{n("データのインポートに失敗しました。ファイル形式を確認してください。")}finally{i(!1)}};return t.jsx("div",{className:"data-import-screen",children:t.jsxs("div",{className:"data-import-container",children:[t.jsx("button",{onClick:m,className:"data-import-back-button",children:"← 設定に戻る"}),t.jsx("h1",{className:"data-import-title",children:"データインポート"}),t.jsx("p",{className:"data-import-description",children:"エクスポートしたJSONファイルを選択して、データを復元できます。"}),t.jsxs("div",{className:"data-import-form",children:[t.jsx("input",{ref:s,type:"file",accept:".json",style:{display:"none"},onChange:()=>{}}),t.jsx("button",{onClick:()=>s.current?.click(),className:"data-import-select-button",children:"ファイルを選択"}),s.current?.files?.[0]&&t.jsxs("p",{style:{fontSize:"14px",color:"#78716c",marginTop:"0.5rem"},children:["選択中: ",s.current.files[0].name]}),t.jsx("button",{onClick:f,disabled:a||!s.current?.files?.[0],className:"data-import-button",children:a?"インポート中...":"データをインポート"})]}),p&&t.jsx("div",{className:"data-import-success",children:"✅ データのインポートが完了しました"}),l&&t.jsxs("div",{className:"data-import-error",children:["⚠️ ",l]}),t.jsxs("div",{className:"data-import-info",children:[t.jsx("h3",{children:"注意事項"}),t.jsxs("ul",{children:[t.jsx("li",{children:"インポート前に既存データのエクスポートを推奨します"}),t.jsx("li",{children:"既存のデータは上書きされます"}),t.jsx("li",{children:"エクスポートしたJSONファイルのみインポート可能です"})]})]})]})})}export{S as default};
