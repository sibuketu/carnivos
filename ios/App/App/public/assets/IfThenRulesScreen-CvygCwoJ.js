import{u as z,j as o}from"./index-CvGLKNdl.js";import{r as n}from"./chart-vendor-BKK2UjWf.js";import"./react-vendor-OvXVS5lI.js";import"./ai-vendor-9LcfXvm6.js";const j=[{id:"eating_out",label:"外食を記録した時",value:"eating_out"},{id:"carbs_20g",label:"糖質を20g以上摂取した時",value:"carbs_20g"},{id:"carbs_10g",label:"糖質を10g以上摂取した時",value:"carbs_10g"},{id:"low_fat",label:"脂質が50g以下の時（脂質不足警告）",value:"low_fat"},{id:"custom",label:"カスタム条件（将来実装）",value:"custom",disabled:!0}],S=[{id:"suggest_recovery",label:"リカバリープロトコルを提案",value:"suggest_recovery"},{id:"auto_recovery",label:"リカバリープロトコルを自動生成",value:"auto_recovery"},{id:"send_notification",label:"通知を送る",value:"send_notification"},{id:"prompt_log",label:"記録を促す",value:"prompt_log"},{id:"custom",label:"カスタムアクション（将来実装）",value:"custom",disabled:!0}];function I(){z();const[l,u]=n.useState([]),[C,b]=n.useState(!1),[s,y]=n.useState(null),[c,p]=n.useState(""),[d,x]=n.useState(""),[r,f]=n.useState(""),[v,a]=n.useState("");n.useEffect(()=>{const e=localStorage.getItem("primal_logic_if_then_rules");if(e)u(JSON.parse(e));else{const t=[{id:"1",name:"外食時",condition:"外食を記録した時",action:"リカバリープロトコルを提案",enabled:!0},{id:"2",name:"糖質摂取時",condition:"糖質を20g以上摂取した時",action:"リカバリープロトコルを自動生成",enabled:!0}];u(t),localStorage.setItem("primal_logic_if_then_rules",JSON.stringify(t))}},[]);const m=e=>{u(e),localStorage.setItem("primal_logic_if_then_rules",JSON.stringify(e))},R=e=>{const t=l.map(i=>i.id===e?{...i,enabled:!i.enabled}:i);m(t)},_=e=>{if(window.confirm("このルールを削除しますか？")){const t=l.filter(i=>i.id!==e);m(t)}},k=e=>{y(e),p(e.name),x(e.condition),f(e.action),a(""),b(!0)},g=()=>{p(""),x(""),f(""),a(""),y(null),b(!1)},w=()=>{if(!c.trim()){a("ルール名を入力してください");return}if(!d){a("条件を選択してください");return}if(!r){a("アクションを選択してください");return}const e=j.find(i=>i.value===d)?.label||d,t=S.find(i=>i.value===r)?.label||r;if(s){const i=l.map(h=>h.id===s.id?{...h,name:c.trim(),condition:e,action:t}:h);m(i)}else{const i={id:Date.now().toString(),name:c.trim(),condition:e,action:t,enabled:!0};m([...l,i])}g()};return o.jsxs("div",{style:{padding:"1rem",maxWidth:"600px",margin:"0 auto"},children:[o.jsxs("div",{style:{marginBottom:"2rem"},children:[o.jsx("h1",{style:{fontSize:"24px",fontWeight:"bold",marginBottom:"0.5rem"},children:"⚙️ If-Thenルール"}),o.jsx("p",{style:{fontSize:"14px",color:"#6b7280"},children:"条件に応じた自動アクションを設定できます。例：外食時、糖質摂取時など"})]}),o.jsx("div",{style:{marginBottom:"2rem"},children:l.length===0?o.jsx("div",{style:{padding:"2rem",textAlign:"center",backgroundColor:"#f9fafb",borderRadius:"8px"},children:o.jsx("p",{style:{fontSize:"14px",color:"#6b7280"},children:"ルールがありません"})}):o.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:l.map(e=>o.jsx("div",{style:{padding:"1rem",backgroundColor:e.enabled?"#fef3c7":"#f9fafb",borderRadius:"8px",border:`1px solid ${e.enabled?"#fbbf24":"#e5e7eb"}`},children:o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start"},children:[o.jsxs("div",{style:{flex:1,cursor:"pointer"},onClick:()=>k(e),children:[o.jsxs("h3",{style:{fontSize:"16px",fontWeight:"bold",marginBottom:"0.5rem"},children:[e.name," ✏️"]}),o.jsxs("p",{style:{fontSize:"12px",color:"#6b7280",marginBottom:"0.25rem"},children:[o.jsx("strong",{children:"条件:"})," ",e.condition]}),o.jsxs("p",{style:{fontSize:"12px",color:"#6b7280"},children:[o.jsx("strong",{children:"アクション:"})," ",e.action]})]}),o.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[o.jsx("button",{onClick:()=>R(e.id),style:{padding:"0.5rem 1rem",minHeight:"44px",minWidth:"44px",backgroundColor:e.enabled?"#10b981":"#e5e7eb",color:e.enabled?"white":"#6b7280",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"12px",fontWeight:"600",touchAction:"manipulation"},children:e.enabled?"ON":"OFF"}),o.jsx("button",{onClick:()=>_(e.id),style:{padding:"0.5rem 1rem",minHeight:"44px",minWidth:"44px",backgroundColor:"#fee2e2",color:"#dc2626",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"12px",fontWeight:"600",touchAction:"manipulation"},children:"削除"})]})]})},e.id))})}),o.jsx("button",{onClick:()=>b(!0),style:{width:"100%",padding:"1rem",minHeight:"44px",backgroundColor:"#b91c1c",color:"white",border:"none",borderRadius:"8px",fontSize:"16px",fontWeight:"600",cursor:"pointer",touchAction:"manipulation"},children:"+ 新しいルールを追加"}),C&&o.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3,padding:"1rem"},onClick:g,children:o.jsxs("div",{style:{backgroundColor:"white",padding:"1.5rem",borderRadius:"8px",width:"100%",maxWidth:"500px",maxHeight:"90vh",overflowY:"auto"},onClick:e=>e.stopPropagation(),children:[o.jsx("h2",{style:{fontSize:"18px",fontWeight:"bold",marginBottom:"1rem"},children:s?"ルールを編集":"新しいルールを追加"}),v&&o.jsx("div",{style:{padding:"0.75rem",backgroundColor:"#fee2e2",color:"#dc2626",borderRadius:"6px",marginBottom:"1rem",fontSize:"14px"},children:v}),o.jsxs("div",{style:{marginBottom:"1.5rem"},children:[o.jsxs("label",{style:{display:"block",fontSize:"14px",fontWeight:"600",marginBottom:"0.5rem"},children:["ルール名 ",o.jsx("span",{style:{color:"#dc2626"},children:"*"})]}),o.jsx("input",{type:"text",value:c,onChange:e=>p(e.target.value),placeholder:"例: 外食時の対応",style:{width:"100%",padding:"0.75rem",minHeight:"44px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"14px",touchAction:"manipulation"}})]}),o.jsxs("div",{style:{marginBottom:"1.5rem"},children:[o.jsxs("label",{style:{display:"block",fontSize:"14px",fontWeight:"600",marginBottom:"0.5rem"},children:["条件 ",o.jsx("span",{style:{color:"#dc2626"},children:"*"})]}),o.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:j.map(e=>o.jsx("button",{onClick:()=>!e.disabled&&x(e.value),disabled:e.disabled,style:{width:"100%",padding:"0.75rem",minHeight:"44px",backgroundColor:d===e.value?"#fef3c7":"#f9fafb",border:`2px solid ${d===e.value?"#fbbf24":"#e5e7eb"}`,borderRadius:"6px",fontSize:"14px",textAlign:"left",cursor:e.disabled?"not-allowed":"pointer",opacity:e.disabled?.5:1,fontWeight:d===e.value?"600":"400",touchAction:"manipulation"},children:e.label},e.id))})]}),o.jsxs("div",{style:{marginBottom:"1.5rem"},children:[o.jsxs("label",{style:{display:"block",fontSize:"14px",fontWeight:"600",marginBottom:"0.5rem"},children:["アクション ",o.jsx("span",{style:{color:"#dc2626"},children:"*"})]}),o.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:S.map(e=>o.jsx("button",{onClick:()=>!e.disabled&&f(e.value),disabled:e.disabled,style:{width:"100%",padding:"0.75rem",minHeight:"44px",backgroundColor:r===e.value?"#dcfce7":"#f9fafb",border:`2px solid ${r===e.value?"#10b981":"#e5e7eb"}`,borderRadius:"6px",fontSize:"14px",textAlign:"left",cursor:e.disabled?"not-allowed":"pointer",opacity:e.disabled?.5:1,fontWeight:r===e.value?"600":"400",touchAction:"manipulation"},children:e.label},e.id))})]}),o.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[o.jsx("button",{onClick:g,style:{flex:1,padding:"0.75rem",minHeight:"44px",backgroundColor:"#f3f4f6",color:"#374151",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:"600",cursor:"pointer",touchAction:"manipulation"},children:"キャンセル"}),o.jsx("button",{onClick:w,style:{flex:1,padding:"0.75rem",minHeight:"44px",backgroundColor:"#b91c1c",color:"white",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:"600",cursor:"pointer",touchAction:"manipulation"},children:s?"更新":"追加"})]})]})}),o.jsx("div",{style:{marginTop:"2rem"},children:o.jsx("button",{onClick:()=>{const e=new CustomEvent("navigateToScreen",{detail:"labs"});window.dispatchEvent(e)},style:{width:"100%",padding:"0.75rem",minHeight:"44px",backgroundColor:"#f3f4f6",color:"#374151",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:"600",cursor:"pointer",touchAction:"manipulation"},children:"戻る"})})]})}export{I as default};
