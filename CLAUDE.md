# Claude Code Rules

**全ルールは `../../second-brain/rules/master_rule.mdc` を参照。**

このファイルはClaude Code専用の補足のみ記載。

---

## Claude Code専用ツール

| タスク | ツール |
|--------|--------|
| ファイル検索 | Glob |
| コード検索 | Grep |
| ファイル読み込み | Read |
| ファイル編集 | Edit |
| ファイル作成 | Write |
| 複雑な探索 | Task (Explore) |
| ターミナル操作 | Bash |

### Bash禁止コマンド
- `cat`, `grep`, `find`, `sed`, `awk` → 専用ツールを使え

---

## 7. 【絶対厳守】ユーザー負担軽減ルール

### 7.1. 自分で確認できることは自分でやる
**ユーザーに聞く前に、自分で確認できることは全て自分でやれ。**

- **禁止行動**: 「〜を確認してください」「〜はどうなっていますか？」とユーザーに丸投げ
- **正しい行動**: WebFetch、browser_snapshot、Read等のツールで自分で確認してから報告
- **例**:
  - ❌「GitHubリポジトリの中身を確認してください」
  - ✅ `WebFetch("https://github.com/user/repo")` で自分で確認

### 7.2. 直リンクで一発
**ステップバイステップのガイドより、直接URLを1つ渡せ。**

- **禁止行動**: 「1.Settingsを開く→2.Identifiersをクリック→3.+ボタンを押す」
- **正しい行動**: 目的のページへの直リンクを1つ提示
- **例**:
  - ❌「Apple Developer Portalを開いて、Certificates, Identifiers & Profilesに行って、Identifiersを選んで...」
  - ✅ `https://developer.apple.com/account/resources/identifiers/add/bundleId`

### 7.3. 詰まったらバトンタッチ
**ブラウザ操作等で詰まったら、無理せず即座にユーザーに返せ。**

- **条件**: 3回試して進まない / エラーが解消しない / 「バトンタッチ」と言われた
- **正しい行動**: 即座に `browser_unlock` してユーザーに状況説明
- **禁止行動**: 詰まったまま無限リトライ

---

## トークン節約リマインダー

**コードを書き始めそうになったら停止！**

→ 「この実装はCursorでやるべき。タスク指示書を作成しますか？」と提案せよ。

---

## Obsidianメモのルール

**新規ファイル作成は最小限に。既存ファイルへの追記を優先。**

1. **メモを書く前に既存ファイルを検索**
   - 同じトピックのファイルが既にないか確認
   - 例: 「食品おすすめ機能」 → IMPROVEMENT_IDEAS.md に追記

2. **新規作成が必要な場合のみ作成**
   - どうしても既存ファイルに当てはまらない場合
   - ファイル名は具体的に（例: FOOD_RECOMMENDATION_SPEC.md）

3. **よく使うメモ先:**
   - アイデア → `IMPROVEMENT_IDEAS.md`
   - 実装タスク → `REMAINING_TASKS.md`
   - 決定事項 → `DECISION_LOG.md`
   - 技術メモ → プロジェクト内の該当ディレクトリ

---

## Antigravityからの提案 (2026-01-28)

### 貯蔵ゲージ機能
HomeScreenに「栄養素貯蔵量」ゲージを追加する提案。

**仕様:**
- **対象栄養素**: Vitamin A, D, B12, Iron（貯蔵可能な4種）
- **初期値**: 70%
- **消費サイクル**: 1週間で消費する計算（14%/日）
- **ゲージ枠色**: オレンジ（通常ゲージと区別）
- **表示場所**: HomeScreen、既存の栄養素ゲージの下

**UIイメージ:**
```
[通常ゲージ: Protein, Fat, Sodium, etc.]
-----------------------------------------
[貯蔵ゲージ: VitA 70%, VitD 85%, B12 60%, Iron 75%] ← オレンジ枠
```

### ウィジェット音声入力
ホーム画面ウィジェットからアプリを開かずに音声で記録。

**例**: 「肉800gと塩8g食べた」→ 即記録

---

---

## 将来のメモ（未実装）

### 人工甘味料トラッキング
- 人工甘味料の摂取をゲージで管理する機能
- 腸内環境への影響を可視化
- 厳格カーニボアとしての一貫性を保つための機能

### AI機能の強化（優先度: 高）
**コンテキスト保持型AI:**
- ユーザー情報（過去の食事履歴、体調記録）を常に記憶
- 例: "腹が痛い" → "3日前からこんな食事でこれが原因では？これからはこうすれば"

**音声による食事記録:**
- ユーザー: "牛200g食った"
- AI: "部位は？"
- ユーザー: "肩ロース"
- AI: "OK、記録した"

**ウィジェット機能（マジか効果狙い）:**
- アプリを開かずに記録・操作可能
- 音声入力対応
- リリース後に追加することで「今まで他のアプリより楽 → 超楽」という体験を提供

### 画像読み取り機能の監視
- PhotoAnalysisModal の使用状況を監視対象に追加
- 精度と使用頻度をトラッキング

### フォローアップクエスチョン機能の再開
- AI会話で追加質問を自動生成
- より詳細なアドバイスを提供

---

**マスタールール**: `../../second-brain/rules/master_rule.mdc`
